let NB_te_temp_save="";const NB_te_enter=()=>{if(13!=event.which)return!0;let e=window.getSelection().getRangeAt(0);"BLOCKQUOTE"==e.endContainer.tagName&&""==e.endContainer.textContent&&document.execCommand("Outdent")},NB_te_control_p=()=>{let e=window.getSelection();e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("formatBlock",!1,"div")},NB_te_control_h1=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("formatBlock",!1,"h1")},NB_te_control_h2=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("formatBlock",!1,"h2")},NB_te_control_h3=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("formatBlock",!1,"h3")},NB_te_control_h4=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("formatBlock",!1,"h4")},NB_te_control_bold=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("bold")},NB_te_control_italic=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("italic")},NB_te_control_strike=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.execCommand("StrikeThrough")},NB_te_control_quote=()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);if("NB_te_post_cont"==e.anchorNode.parentNode.id||"NB_te_post_cont"==e.anchorNode.parentNode.offsetParent.id)if(document.execCommand("insertParagraph"),null!=e.modify)e.modify("move","backward","line"),document.execCommand("formatBlock",!1,"blockquote");else{let t=document.createElement("blockquote");t.setAttribute("contentEditable","true"),e.focusNode.before(t),t.focus(),document.execCommand("formatBlock",!1,"div")}},NB_te_control_link=(e=!1)=>{let t=window.getSelection();if(null==t.anchorNode)return;t.getRangeAt(0);if("NB_te_post_cont"!=t.anchorNode.parentNode.id&&"NB_te_post_cont"!=t.anchorNode.parentNode.offsetParent.id)return;let n=document.createElement("div");n.id="NB_te_create_link_cont",n.classList.add("NB_link_input_cont","noselect"),n.setAttribute("contentEditable","false");let o=document.createElement("div");o.classList.add("NB_link_input_content");let c=document.createElement("span"),l="제목";e&&(l="Title"),c.textContent=l;let d=document.createElement("input"),r="제목을 입력해주세요.";e&&(r="Enter the link name."),Object.assign(d,{type:"text",max:50,placeholder:r}),o.append(c,d),n.append(o),d.onblur=(()=>{NB_te_remove_link()}),(o=document.createElement("div")).classList.add("NB_link_input_content"),l="링크",e&&(l="Link"),(c=document.createElement("span")).textContent=l,d=document.createElement("input"),r="URL을 입력해주세요.",e&&(r="Enter the URL."),Object.assign(d,{type:"text",max:1e3,placeholder:r}),o.append(c,d),n.append(o),d.onblur=(()=>{NB_te_remove_link()});let _=document.createElement("div");_.classList.add("NB_link_done_btn");let i="확인";e&&(i="Create"),_.textContent=i,n.append(_),_.onclick=(()=>{NB_te_create_link(n)}),null!=t.modify&&t.modify("move","backward","line"),t.focusNode.parentNode.classList.contains("NB_link_btn")?t.focusNode.parentNode.parentNode.after(n):null==t.focusNode.nextSibling?t.focusNode.after(n):(null!=t.modify&&t.modify("forward",!1,"line"),t.focusNode.nextSibling.append(n)),document.querySelector("#NB_te_create_link_cont > .NB_link_input_content > input").focus()},NB_te_remove_link=()=>{window.getSelection().getRangeAt(0);for(let e of document.querySelectorAll(".NB_link_input_cont"))""==e.querySelectorAll("input")[0].value&&""==e.querySelectorAll("input")[1].value&&e.remove()},NB_te_create_link=e=>{for(let t of e.querySelectorAll("input"))if(""==t.value)return t.focus(),!1;let t=e.querySelectorAll("input")[0].value,n=e.querySelectorAll("input")[1].value,o=document.createElement("div"),c=document.createElement("a");c.textContent=t,c.classList.add("NB_link_btn"),Object.assign(c,{contentEditable:"true",target:"_blank",href:n}),o.textContent=" ",o.append(c),e.remove();let l=window.getSelection(),d=(l.getRangeAt(0),l.anchorNode);for(;"NB_te_post_cont"!=d.id&&"NB_te_post_cont"!=d.parentNode.id;)d=d.parentNode;null!=l.modify&&l.modify("forward",!1,"line"),"NB_te_post_cont"==d.id?d.append(o):null!=d.tagName&&d.querySelector("a")?d.before(o):null!=d.childNodes[0]&&"BR"==d.childNodes[0].tagName?d.append(o):d.after(o),null!=l.modify&&l.modify("move","forward","paragraph")},NB_te_control_image=()=>{let e=document.querySelector("#NB_te_control_image_content"),t=URL.createObjectURL(e.files[0]),n=window.getSelection();console.log(t),console.log(e.files[0]);let o=document.createElement("img");o.classList.add("NB_img_cont"),o.setAttribute("src",t),n.focusNode.after(o),window.URL.revokeObjectURL(t)},NBnote=(e="#12b886",t=!0,n=!0,o=!1)=>{this.newControlElement=(e=>{let t=document.createElement(e);return t.classList.add("NB_te_control_box"),t}),this.newControlBreak=(()=>{let e=document.createElement("div");return e.classList.add("NB_te_control_box_break"),e}),document.querySelector("#NB-texteditor").style.setProperty("--NBnote-color",e);let c=document.createElement("div");c.classList.add("NB_te_cont");let l=document.createElement("div");l.classList.add("NB_te_title_cont");let d=document.createElement("input");d.classList.add("NB_te_title_input");let r="제목을 입력해주세요.";o&&(r="Enter your title."),Object.assign(d,{id:"NB_te_title_input",type:"text",placeholder:r}),l.append(d);let _=document.createElement("div");_.classList.add("NB_te_control_cont","NB_noselect");let i=this.newControlElement("div");if(i.id="NB_te_control_p",i.textContent="P",_.append(i),i.onclick=(()=>{NB_te_control_p()}),(i=this.newControlElement("div")).id="NB_te_control_h1",i.textContent="H1",i.onclick=(()=>{NB_te_control_h1()}),_.append(i),(i=this.newControlElement("div")).id="NB_te_control_h2",i.textContent="H2",i.onclick=(()=>{NB_te_control_h2()}),_.append(i),(i=this.newControlElement("div")).id="NB_te_control_h3",i.textContent="H3",i.onclick=(()=>{NB_te_control_h3()}),_.append(i),(i=this.newControlElement("div")).id="NB_te_control_h4",i.textContent="H4",i.onclick=(()=>{NB_te_control_h4()}),_.append(i),_.append(this.newControlBreak()),(i=this.newControlElement("div")).id="NB_te_control_bold",i.textContent="B",i.onclick=(()=>{NB_te_control_bold()}),_.append(i),(i=this.newControlElement("div")).id="NB_te_control_italic",i.textContent="I",i.onclick=(()=>{NB_te_control_italic()}),_.append(i),(i=this.newControlElement("div")).id="NB_te_control_strike",i.textContent="T",i.style.textDecoration="line-through",i.onclick=(()=>{NB_te_control_strike()}),_.append(i),_.append(this.newControlBreak()),(i=this.newControlElement("div")).id="NB_te_control_quote",i.textContent="「 」",i.onclick=(()=>{NB_te_control_quote()}),_.append(i),t&&((i=this.newControlElement("div")).id="NB_te_control_link",i.textContent="∝",i.onclick=(()=>{NB_te_control_link(o)}),_.append(i)),n){(i=this.newControlElement("div")).id="NB_te_control_image";let e=document.createElement("input");Object.assign(e,{id:"NB_te_control_image_content",type:"file"}),e.accept="img/*",e.onchange=(()=>{NB_te_control_image()}),i.append(e),i.append("⇧"),i.onclick=(()=>{NB_te_control_image()}),i.onclick=(()=>{let e=window.getSelection();if(null==e.anchorNode)return;e.getRangeAt(0);"NB_te_post_cont"!=e.anchorNode.parentNode.id&&"NB_te_post_cont"!=e.anchorNode.parentNode.offsetParent.id||document.querySelector("#NB_te_control_image_content").click()}),_.append(i)}let a=document.createElement("div");a.classList.add("NB_te_post_cont");let N="내용을 입력해주세요.";o&&(N="Enter your contents."),a.setAttribute("placeholder",N),Object.assign(a,{id:"NB_te_post_cont",contentEditable:"true",spellcheck:"false"}),a.onkeypress=(()=>{NB_te_enter()}),c.append(l),c.append(_),c.append(a),document.querySelector("#NB-texteditor").append(c)};